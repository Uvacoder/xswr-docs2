# Persistent storage

You can create a persistent storage and use it only where you want.

## Creating a storage

Create a storage either at top-level...

```tsx
const storage = new XSWR.AsyncLocalStorage()

function useHello() {
  const handle = XSWR.useSingle(
    "/api/hello", 
    fetchAsJson, 
    { storage })

  XSWR.useFetch(handle)
  return handle
}
```

...or using a hook.

```tsx 
function useHello() {
  const storage = XSWR.useAsyncLocalStorage()
  
  const handle = XSWR.useSingle(
    "/api/hello", 
    fetchAsJson, 
    { storage })

  XSWR.useFetch(handle)
  return handle
}
```

You can also pass it into a CoreProvider or ParamsProvider.

```tsx
const storage = new XSWR.AsyncLocalStorage()

function MyWrapper() {
  return <XSWR.CoreProvider
    storage={storage}>
    <MyApp />
  </XSWR.CoreProvider>
}
```

## Types of storage

### Async Local Storage

- Constructor: `new XSWR.AsyncLocalStorage(serializer?)`
- Hook (static): `useAsyncLocalStorage(serializer?)`

This storage is asynchronous and uses the browser LocalStorage.

Being asynchronous allows the use of SSR and storing large objects, but it won't display data on first render.

If you want to display data on first render, you can do so by using either:
- SyncLocalStorage
- useFallback()

You can pass a custom serializer (default is JSON) for serializing values (keys are already serialized by the `Params` serializer).

### Sync Local Storage

- Constructor: `new XSWR.SyncLocalStorage(serializer?)`
- Hook (static): `useSyncLocalStorage(serializer?)`

This storage is synchronous and uses the browser LocalStorage.

Being synchronous allows displaying data on first render, but it won't work with SSR or for storing large objects.

You can pass a custom serializer (default is JSON) for serializing values (keys are already serialized by the `Params` serializer).